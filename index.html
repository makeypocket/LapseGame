<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lapse Game 2075</title>
    <link rel="stylesheet" href="style.css?v=2">
</head>
<body>
    <div class="game-container">
        <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –Ω–∞—á–∞–ª–æ –∏–≥—Ä—ã -->
        <div id="settings-screen" class="screen active">
            <div class="settings-panel">
                <h1 class="game-title"></h1>
                <p class="game-subtitle"></p>
                
                <div class="settings-form">
                    <div class="input-group">
                        <label for="language-select"></label>
                        <select id="language-select">
                            <option value="en">English</option>
                            <option value="ru">–†—É—Å—Å–∫–∏–π</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label for="api-key"></label>
                        <input type="password" id="api-key" placeholder="">
                        <small></small>
                    </div>
                    
                    <div class="input-group">
                        <label for="model-select"></label>
                        <select id="model-select">
                            <option value="gemini-fast">Google Gemini 2.5 Flash Lite (–û—á–µ–Ω—å –±—ã—Å—Ç—Ä—ã–π)</option>
                            <option value="openai-fast">OpenAI GPT-5 Nano (–î–æ–ª–≥–∏–π –∏ —É–º–Ω—ã–π)</option>
                            <option value="grok">xAI Grok 4 Fast (–ë—ã—Å—Ç—Ä—ã–π –∏ —É–º–Ω—ã–π)</option>
                            <option value="qwen-coder">Qwen3 Coder 30B (–°—Ä–µ–¥–Ω–∏–π –∏ —É–º–Ω—ã–π)</option>
                        </select>
                    </div>
                    
                    <div class="input-group">
                        <label for="temperature"></label>
                        <input type="number" id="temperature" min="0" max="2" step="0.1" value="0.85">
                    </div>
                    
                    <div class="input-group">
                        <label for="max-tokens"></label>
                        <input type="number" id="max-tokens" min="0" max="10000" step="500" value="" placeholder="">
                        <small></small>
                    </div>
                    
                    <button id="start-game-btn" class="btn-primary" type="button" onclick="console.log('Inline onclick works');"></button>
                </div>
            </div>
        </div>

        <!-- –ò–≥—Ä–æ–≤–æ–π —ç–∫—Ä–∞–Ω -->
        <div id="game-screen" class="screen">
            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
            <div class="stats-bar">
                <div class="stat-item" data-stat="environment">
                    <div class="stat-icon">üåø</div>
                    <div class="stat-progress">
                        <div class="stat-fill" style="height: 50%"></div>
                    </div>
                    <div class="stat-label"></div>
                    <div class="stat-value">50</div>
                </div>
                <div class="stat-item" data-stat="population">
                    <div class="stat-icon">üë•</div>
                    <div class="stat-progress">
                        <div class="stat-fill" style="height: 50%"></div>
                    </div>
                    <div class="stat-label"></div>
                    <div class="stat-value">50</div>
                </div>
                <div class="stat-item" data-stat="military">
                    <div class="stat-icon">üõ°Ô∏è</div>
                    <div class="stat-progress">
                        <div class="stat-fill" style="height: 50%"></div>
                    </div>
                    <div class="stat-label"></div>
                    <div class="stat-value">50</div>
                </div>
                <div class="stat-item" data-stat="economy">
                    <div class="stat-icon">üí∞</div>
                    <div class="stat-progress">
                        <div class="stat-fill" style="height: 50%"></div>
                    </div>
                    <div class="stat-label"></div>
                    <div class="stat-value">50</div>
                </div>
            </div>

            <!-- –ì–æ–¥ -->
            <div class="year-display">
                <span>–ì–æ–¥: <span id="year-value">2075</span></span>
            </div>

            <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ -->
            <div class="card-container">
                <div id="game-card" class="card" style="display: none; opacity: 0;">
                    <div class="card-background"></div>
                    <div class="card-content">
                        <div class="character-info">
                            <div class="character-icon" id="character-icon">üë§</div>
                            <div class="character-name" id="character-name"></div>
                        </div>
                        <div class="card-text" id="card-text"></div>
                        <div class="choices-overlay">
                            <div class="choice-left" id="choice-left">
                                <span id="choice-left-text"></span>
                            </div>
                            <div class="choice-right" id="choice-right">
                                <span id="choice-right-text"></span>
                            </div>
                        </div>
                        <div class="choice-buttons">
                            <button class="choice-btn choice-btn-left" id="choice-btn-left"></button>
                            <button class="choice-btn choice-btn-right" id="choice-btn-right"></button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ü–µ—Ä–∫–∏ -->
            <div class="perks-bar" id="perks-bar">
                <div class="perks-title"></div>
                <div class="perks-list" id="perks-list"></div>
            </div>

            <!-- –ö–Ω–æ–ø–∫–∞ —Ä–µ—Å—Ç–∞—Ä—Ç–∞ -->
            <button id="restart-btn" class="btn-restart" style="display: none;"></button>

            <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
            <div id="loading-indicator" class="loading-indicator" style="display: none;">
                <div class="spinner"></div>
                <p></p>
                <button id="retry-btn" class="btn-primary" style="display: none; margin-top: 15px;"></button>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –æ–∫–æ–Ω—á–∞–Ω–∏—è –∏–≥—Ä—ã -->
        <div id="game-over-screen" class="screen">
            <div class="game-over-panel">
                <h2></h2>
                <p id="game-over-message"></p>
                <button id="new-game-btn" class="btn-primary"></button>
            </div>
        </div>
    </div>

    <!-- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Ç–µ—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã -->
    <script>
        console.log('=== LAPSE GAME DEBUG ===');
        console.log('HTML loaded');
        console.log('Current URL:', window.location.href);
        console.log('Protocol:', window.location.protocol);
        
        // –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç–æ —á–µ—Ä–µ–∑ file://
        if (window.location.protocol === 'file:') {
            console.warn('–í–ù–ò–ú–ê–ù–ò–ï: –§–∞–π–ª –æ—Ç–∫—Ä—ã—Ç —á–µ—Ä–µ–∑ file:// –ø—Ä–æ—Ç–æ–∫–æ–ª');
            console.warn('–ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–≥—É—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä.');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
            setTimeout(() => {
                const warning = document.createElement('div');
                warning.style.cssText = 'position:fixed;top:0;left:0;right:0;background:#ff9800;color:white;padding:15px;text-align:center;z-index:10000;font-weight:bold;';
                warning.innerHTML = '‚ö†Ô∏è –§–∞–π–ª –æ—Ç–∫—Ä—ã—Ç —á–µ—Ä–µ–∑ file://. –î–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä. <a href="test.html" style="color:white;text-decoration:underline;">–û—Ç–∫—Ä—ã—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É</a>';
                document.body.appendChild(warning);
                setTimeout(() => warning.remove(), 10000);
            }, 1000);
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
        window.addEventListener('DOMContentLoaded', () => {
            console.log('DOM Content Loaded');
            const startBtn = document.getElementById('start-game-btn');
            console.log('Start button found:', !!startBtn);
            
            if (startBtn) {
                console.log('Start button element:', startBtn);
                // –ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç - –º–µ–Ω—è–µ–º —Ü–≤–µ—Ç –∫–Ω–æ–ø–∫–∏ –ø—Ä–∏ –∫–ª–∏–∫–µ
                const testHandler = function() {
                    console.log('BUTTON CLICKED! This function works!');
                    alert('–ö–Ω–æ–ø–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç! JavaScript –∑–∞–≥—Ä—É–∂–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ.\n\n–¢–µ–ø–µ—Ä—å –¥–æ–ª–∂–Ω–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è –æ—Å–Ω–æ–≤–Ω–∞—è –∏–≥—Ä–∞...');
                    this.style.background = 'red';
                    setTimeout(() => {
                        this.style.background = '';
                    }, 1000);
                };
                startBtn.addEventListener('click', testHandler);
                console.log('Test handler attached to button');
            } else {
                console.error('Start button NOT FOUND!');
                alert('–û–®–ò–ë–ö–ê: –ö–Ω–æ–ø–∫–∞ "–ù–∞—á–∞—Ç—å –∏–≥—Ä—É" –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ!');
            }
        });
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∑–∫—É –≤–Ω–µ—à–Ω–µ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞
        window.addEventListener('error', (e) => {
            console.error('Global error:', e);
            if (e.filename && e.filename.includes('script.js')) {
                console.error('ERROR loading script.js:', e.message);
                alert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ script.js: ' + e.message + '\n\n–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª script.js –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ç–æ–π –∂–µ –ø–∞–ø–∫–µ, —á—Ç–æ –∏ index.html');
            }
        });
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∑–∫—É script.js
        setTimeout(() => {
            if (typeof GameUI === 'undefined') {
                console.error('GameUI class not found! script.js may not have loaded.');
                alert('–û–®–ò–ë–ö–ê: script.js –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –æ—à–∏–±–∫–∏!\n\n–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π.');
            } else {
                console.log('GameUI class found - script.js loaded successfully');
            }
        }, 2000);
    </script>
    
    <!-- –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è —Ç–µ—Å—Ç–∞, –µ—Å–ª–∏ –≤–Ω–µ—à–Ω–∏–π —Å–∫—Ä–∏–ø—Ç –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è -->
    <script>
        // –ü—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å script.js –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
        function loadScript(src, callback) {
            const script = document.createElement('script');
            script.src = src;
            script.onload = function() {
                console.log(src + ' –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ');
                if (callback) callback(true);
            };
            script.onerror = function(e) {
                console.error('–û–®–ò–ë–ö–ê –∑–∞–≥—Ä—É–∑–∫–∏ ' + src, e);
                if (callback) callback(false);
            };
            document.head.appendChild(script);
        }
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º script.js —Å –∫—ç—à-–±–∞—Å—Ç–µ—Ä–æ–º
        loadScript('script.js?v=' + Date.now(), function(success) {
            if (!success) {
                console.error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å script.js');
                alert('–û–®–ò–ë–ö–ê: –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å script.js!\n\n–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:\n1. –§–∞–π–ª –ø–æ–≤—Ä–µ–∂–¥–µ–Ω –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –æ—à–∏–±–∫–∏\n2. –ü—Ä–æ–±–ª–µ–º–∞ —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π —Ñ–∞–π–ª–∞\n3. –ë—Ä–∞—É–∑–µ—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ\n\n–ü–æ–ø—Ä–æ–±—É–π—Ç–µ:\n- –û—Ç–∫—Ä—ã—Ç—å —á–µ—Ä–µ–∑ –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä (python -m http.server)\n- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫');
            } else {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–ª–∞—Å—Å GameUI –∑–∞–≥—Ä—É–∑–∏–ª—Å—è
                setTimeout(() => {
                    if (typeof GameUI === 'undefined') {
                        console.error('GameUI –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ script.js');
                        alert('–û–®–ò–ë–ö–ê: script.js –∑–∞–≥—Ä—É–∂–µ–Ω, –Ω–æ GameUI –∫–ª–∞—Å—Å –Ω–µ –Ω–∞–π–¥–µ–Ω!\n\n–í–æ–∑–º–æ–∂–Ω–æ, –≤ —Ñ–∞–π–ª–µ –µ—Å—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞.');
                    } else {
                        console.log('GameUI –∫–ª–∞—Å—Å –Ω–∞–π–¥–µ–Ω - –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç!');
                    }
                }, 500);
            }
        });
    </script>
</body>
</html>

